"0","incidents_df <- data.frame(rid = df$rid, date = df$flight_date, origin = df$airport, airline = df$airline, aircraft = df$aircraft, flightPhase = df$flight_phase, altitude = df$altitude_ft, conditions = df$sky_conditions, "
"0","                           warning = df$pilot_warned_flag)"
"0","#format the date"
"0","incidents_df$date <- as.Date(incidents_df$date, format = ""%m/%d/%Y"")"
"0",""
"0",""
"0","#match the foreign key - origin"
"0","incidents_df <- incidents_df %>% "
"0","  left_join(airports_df %>% select(aid, airportName), by = c(""origin"" = ""airportName"")) %>% "
"0","  select(rid, date, origin = aid, airline, aircraft, flightPhase, altitude, conditions, warning)"
"2","Warning: Each row in `x` is expected to match at most 1 row in `y`."
"0","#match the foreign key - condition"
"0","incidents_df <- incidents_df %>% "
"0","  left_join(conditions_df %>% select(cid, condition), by = c(""conditions"" = ""condition"")) %>% "
"0","  select(rid, date, origin, airline, aircraft, flightPhase, altitude, conditions = cid, warning)"
